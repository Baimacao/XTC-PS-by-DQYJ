<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>账号系统 | 小天才开放平台 | 文档</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="小天才开放平台,小天才开发者平台,帮助开发者更好地开发平台应用。">
    
    <link rel="preload" href="static/css/0.styles.3e96b5ae.css" as="style"><link rel="preload" href="https://developer.okii.com/docs/assets/js/app.c5cf0902.js" as="script"><link rel="preload" href="https://developer.okii.com/docs/assets/js/2.64c56ba3.js" as="script"><link rel="preload" href="https://developer.okii.com/docs/assets/js/8.63a01d72.js" as="script"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/10.7dabc864.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/11.a857b413.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/12.b65651e7.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/13.0ec7aaa7.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/14.ae03732c.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/15.bd585f03.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/16.8ce8785d.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/17.83cf954d.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/18.0a544859.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/19.3e8a6e86.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/20.b97b66fb.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/21.e0a445ca.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/22.c6f18896.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/23.bb06cbb4.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/24.3a8f5dc7.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/25.6258f33e.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/26.d995a2f2.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/27.1fadabf2.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/28.0708c0c2.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/29.3ac293a5.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/3.89808b9c.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/30.cd196038.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/31.29284ed9.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/32.6e0fbfcd.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/33.5b4e9fbb.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/34.faf644ab.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/35.d64c3b26.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/36.ffa0bc2d.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/37.4efadb19.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/38.1301eb3d.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/39.765462f8.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/4.40351588.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/40.8ae7b2ef.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/41.b53a935b.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/42.1b8db389.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/43.57d2f36e.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/44.4f42e10b.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/45.49d1f12c.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/46.b00351d5.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/47.ee33eed7.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/48.d593d13f.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/49.90697f7e.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/5.7d14a609.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/50.eb9d6e79.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/6.145dd442.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/7.d2b7988b.js"><link rel="prefetch" href="https://developer.okii.com/docs/assets/js/9.f91da2c8.js">
    <link rel="stylesheet" href="static/css/0.styles.3e96b5ae.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewbox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="docs.html" class="home-link router-link-active"><!----> <span class="site-name">小天才开放平台 | 文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  回到首页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="apply.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  申请入驻
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="contact.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  联系我们
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="en.html" class="nav-link">
  English
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  回到首页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="apply.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  申请入驻
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="contact.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  联系我们
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="en.html" class="nav-link">
  English
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>应用发布</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="01-shelf.html" class="sidebar-link">上架流程</a></li><li><a href="03-version.html" class="sidebar-link">版本提供</a></li><li><a href="02-resource.html" class="sidebar-link">审核规范</a></li><li><a href="06-publish.html" class="sidebar-link">市场监控标准</a></li><li><a href="04-principle.html" class="sidebar-link">应用违规处理（试运行）</a></li><li><a href="05-notice.html" class="sidebar-link">侵权投诉处理流程</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>开发指南</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="00-model.html" class="sidebar-link">开放机型</a></li><li><a href="01-setting.html" class="sidebar-link">基础配置</a></li><li><a href="02-permission.html" class="sidebar-link">应用权限</a></li><li><a href="" aria-current="page" class="active sidebar-link">账号系统</a></li><li><a href="08-service.html" class="sidebar-link">应用服务号</a></li><li><a href="10-paysdk.html" class="sidebar-link">支付 SDK 说明</a></li><li><a href="03-function.html" class="sidebar-link">API开放接口</a></li><li><a href="04-optimization.html" class="sidebar-link">注意事项</a></li><li><a href="06-problem.html" class="sidebar-link">常见问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>设计指南</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="interaction.html" class="sidebar-link">交互设计</a></li><li><a href="vision.html" class="sidebar-link">视觉设计</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>快应用接入</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="01-guide.html" class="sidebar-link">快应用接入</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="账号系统"><a href="#账号系统" class="header-anchor">#</a> 账号系统</h1> <p></p><div class="table-of-contents"><ul><li><a href="#_1-小天才账号系统是什么">1. 小天才账号系统是什么？</a></li><li><a href="#_2-账号系统对接流程">2. 账号系统对接流程</a><ul><li><a href="#_2-1-小天才开放平台入驻申请">2.1 小天才开放平台入驻申请</a></li><li><a href="#_2-2-开发对接">2.2 开发对接</a></li><li><a href="#_2-3-测试对接">2.3 测试对接</a></li><li><a href="#_2-4-应用上线">2.4 应用上线</a></li></ul></li><li><a href="#_3-账号系统对接指引">3. 账号系统对接指引</a><ul><li><a href="#_3-1-账号授权服务时序图">3.1 账号授权服务时序图</a></li><li><a href="#_3-2-根据授权码调用token接口获取身份凭证accesstoken">3.2 根据授权码调用token接口获取身份凭证accessToken</a></li><li><a href="#_3-3-根据refreshtoken接口获取新的accesstoken">3.3 根据refreshToken接口获取新的accessToken</a></li></ul></li><li><a href="#_4-获取用户账号信息">4. 获取用户账号信息</a><ul><li><a href="#_4-1-概述">4.1 概述</a></li><li><a href="#_4-2-根据accesstoken获取用户信息">4.2 根据accessToken获取用户信息</a></li><li><a href="#_4-3-新openid转换成旧openid兼容逻辑处理-2019年9月之前接入的第三方使用">4.3  新openId转换成旧openId兼容逻辑处理（2019年9月之前接入的第三方使用）</a></li></ul></li><li><a href="#_5-开放排名服务">5. 开放排名服务</a><ul><li><a href="#_5-1-概述">5.1 概述</a></li><li><a href="#_5-2-开放排名服务时序图">5.2 开放排名服务时序图</a></li><li><a href="#_5-3-上传应用排名数据">5.3 上传应用排名数据</a></li><li><a href="#_5-4-获取好友排行榜数据">5.4 获取好友排行榜数据</a></li><li><a href="#_5-5-获取校园排行榜数据">5.5 获取校园排行榜数据</a></li></ul></li></ul></div><p></p> <h2 id="_1-小天才账号系统是什么"><a href="#_1-小天才账号系统是什么" class="header-anchor">#</a> 1. 小天才账号系统是什么？</h2> <p>通俗的讲，就是一个手表在一个应用中的账号，一个手表在不同应用的账号标识都是不同且唯一的。此外，基于小天才账号授权可获取用户昵称、头像等基本信息，也可在此之上提供应用服务号、好友排行等服务。</p> <p><img src="static/picture/account01.4c8ed0ea.png" alt=""></p> <h2 id="_2-账号系统对接流程"><a href="#_2-账号系统对接流程" class="header-anchor">#</a> 2. 账号系统对接流程</h2> <h3 id="_2-1-小天才开放平台入驻申请"><a href="#_2-1-小天才开放平台入驻申请" class="header-anchor">#</a> 2.1 小天才开放平台入驻申请</h3> <p>您在开放平台填完<strong>入驻申请之后，在微信群中通知XTC的同学</strong>，XTC这边审核之后会给您的应用分配appId、appSecret和第三方应用权限范围（默认头像、名称和推送），之后会将appId和appSecret信息同步到群中。</p> <h3 id="_2-2-开发对接"><a href="#_2-2-开发对接" class="header-anchor">#</a> 2.2 开发对接</h3> <ul><li>需集成表端账户系统sdk。</li> <li><strong>sdk获取方式：</strong> 群中找小天才的技术同学获取。</li></ul> <h3 id="_2-3-测试对接"><a href="#_2-3-测试对接" class="header-anchor">#</a> 2.3 测试对接</h3> <ul><li><p>测试环境的appId、appSecret与正式环境<strong>可能不同</strong>，在微信群同步应用时会说明appId和appSecret对应哪个环境，您在对应环境使用对应的appId等应用信息传参即可。</p></li> <li><p>访问小天才的服务器接口，调试时请使用测试环境域名，调试成功提测正式版本，请换成正式环境域名。</p> <blockquote><ul><li><strong>测试环境域名：</strong> https://api-module.okii.com</li> <li><strong>正式环境域名：</strong> https://api.watch.okii.com</li></ul></blockquote></li> <li><p><strong>请注意，手表有测试环境和正式环境之分</strong>。判断手表当前环境：点击手表绑定号—&gt;观察右上角，如果有模块二字，则为测试环境，否则为正式环境，下图为测试环境手表示例图。</p></li></ul> <p><img src="static/picture/watchenv.cc85e2db.jpg" alt=""></p> <ul><li><strong>手表环境的切换方式：</strong> 请在微信群联系小天才的同学。</li></ul> <h3 id="_2-4-应用上线"><a href="#_2-4-应用上线" class="header-anchor">#</a> 2.4 应用上线</h3> <h2 id="_3-账号系统对接指引"><a href="#_3-账号系统对接指引" class="header-anchor">#</a> 3. 账号系统对接指引</h2> <h3 id="_3-1-账号授权服务时序图"><a href="#_3-1-账号授权服务时序图" class="header-anchor">#</a> 3.1 账号授权服务时序图</h3> <p><img src="static/picture/account03.9ceb4381.png" alt="账号授权服务时序图"></p> <blockquote><p>注：当前appId、appSecret和第三方应用权限范围由小天才服务器分配后在群里进行信息同步。</p></blockquote> <h3 id="_3-2-根据授权码调用token接口获取身份凭证accesstoken"><a href="#_3-2-根据授权码调用token接口获取身份凭证accesstoken" class="header-anchor">#</a> 3.2 根据授权码调用token接口获取身份凭证accessToken</h3> <h4 id="_3-2-1-调用时机"><a href="#_3-2-1-调用时机" class="header-anchor">#</a> 3.2.1 调用时机</h4> <ul><li>您从客户端<strong>通过sdk拿到授权认证码code后</strong>，授权码code的<strong>有效期为10分钟</strong>。</li></ul> <h4 id="_3-2-2-接口说明"><a href="#_3-2-2-接口说明" class="header-anchor">#</a> 3.2.2 接口说明</h4> <ul><li><p><strong>功能：拿到手表的临时身份信息凭证，通过这个凭证可以获取手表头像、名称等信息。</strong></p></li> <li><p><strong>请求方式：POST</strong></p></li> <li><p><strong>协议类型：HTTPS</strong></p></li> <li><p><strong>数据格式：json</strong></p></li> <li><p><strong>服务URL：</strong></p> <blockquote><p>测试环境：https://api-module.okii.com/oauth/token</p> <p>正式环境：https://api.watch.okii.com/oauth/token</p></blockquote></li> <li><p><strong>注意：用户可以主动取消授权，此时之前获取的token便不再有效，目前取消授权不会通知第三方。</strong></p></li> <li><p><strong>消息方向：第三方应用-&gt;开放服务</strong></p></li> <li><p><strong>请求参数</strong></p></li></ul> <table><thead><tr><th>参数</th> <th>参数名称</th> <th>类型</th> <th>必填</th> <th>参数说明</th></tr></thead> <tbody><tr><td>appId</td> <td>第三方应用唯一标识</td> <td>int</td> <td>是</td> <td>由小天才分配给接入方的应用标识ID</td></tr> <tr><td>appSecret</td> <td>第三方应用秘钥</td> <td>String</td> <td>是</td> <td>由小天才分配给接入方的应用秘钥</td></tr> <tr><td>code</td> <td>授权认证码</td> <td>String</td> <td>是</td> <td><strong>通过小天才手表SDK获取的授权码code（有效期10分钟）</strong></td></tr> <tr><td>grantType</td> <td>授权类型</td> <td>String</td> <td>是</td> <td>固定值:<strong>authorization_code</strong></td></tr></tbody></table> <ul><li>示例</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;appId&quot;</span><span class="token operator">:</span> <span class="token number">100001</span><span class="token punctuation">,</span>
    <span class="token property">&quot;appSecret&quot;</span><span class="token operator">:</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;grantType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;authorization_code&quot;</span><span class="token punctuation">,</span><span class="token comment">//固定值</span>
    <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0b6bbfedc7044676a65c63e6959d81c2&quot;</span><span class="token comment">//授权码</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>响应消息</strong></li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;000001&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;desc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SUCCESS&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;accessToken&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3d9eb36db7594c569702a940e9e86b0d&quot;</span><span class="token punctuation">,</span><span class="token comment">// 用户授权凭证，有效期3天</span>
    <span class="token property">&quot;expiresTime&quot;</span><span class="token operator">:</span> <span class="token number">259200</span><span class="token punctuation">,</span> <span class="token comment">// token过期时间，单位秒（S）</span>
    <span class="token property">&quot;refreshToken&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8e49c6c296024518bf352c97a29cadf7&quot;</span><span class="token punctuation">,</span><span class="token comment">// token过期时可以通过该参数获取新的token，有效期90天</span>
    <span class="token property">&quot;openId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;a614044b00a8406387aeba629b0e4f75&quot;</span><span class="token punctuation">,</span><span class="token comment">// 表示该手表在该应用的唯一ID</span>
    <span class="token property">&quot;scope&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>注：scope传值范围目前有下列几种，权限需要小天才开放平台进行分配</p></blockquote> <table><thead><tr><th>值</th> <th>权限名称</th></tr></thead> <tbody><tr><td>1</td> <td>用户的基础信息</td></tr> <tr><td>4</td> <td>用户好友排行</td></tr> <tr><td>5</td> <td>服务号更新时推送到家庭圈、手表</td></tr></tbody></table> <ul><li><strong>返回状态</strong></li></ul> <table><thead><tr><th>状态码</th> <th>提示消息</th></tr></thead> <tbody><tr><td>&quot;12001&quot;</td> <td>参数无效</td></tr> <tr><td>&quot;12002&quot;</td> <td>授权类型有误</td></tr> <tr><td>&quot;12007&quot;</td> <td>APPID或APPSecret信息无效</td></tr> <tr><td>&quot;12004&quot;</td> <td>授权码已过期、已经被使用过或者不存在（<strong>如果不是前两种情况，请检查手表环境和服务器的调用环境URL是否一致，手表环境查看见2.3节</strong>）</td></tr></tbody></table> <h3 id="_3-3-根据refreshtoken接口获取新的accesstoken"><a href="#_3-3-根据refreshtoken接口获取新的accesstoken" class="header-anchor">#</a> 3.3 根据refreshToken接口获取新的accessToken</h3> <h4 id="_3-3-1-功能描述"><a href="#_3-3-1-功能描述" class="header-anchor">#</a> 3.3.1 功能描述</h4> <p>您通过授权认证码<code>code</code>调用<code>token</code>接口获取<code>accessToken</code>（<strong>有效期三天</strong>）的同时会返回一个<code>refreshToken</code>（<strong>有效期三个月</strong>），当<code>accessToken</code>过期后可通过<code>refreshToken</code>接口获取新的<code>accessToken</code>，相当于续期操作。</p> <h4 id="_3-3-2-接口说明"><a href="#_3-3-2-接口说明" class="header-anchor">#</a> 3.3.2 接口说明</h4> <ul><li><p><strong>请求方式：POST</strong></p></li> <li><p><strong>协议类型：HTTPS</strong></p></li> <li><p><strong>数据格式：json</strong></p></li> <li><p><strong>服务URL：</strong></p> <blockquote><p>测试环境：https://api-module.okii.com/oauth/refreshToken</p> <p>正式环境：https://api.watch.okii.com/oauth/refreshToken</p></blockquote></li> <li><p><strong>消息方向：第三方应用-&gt;授权服务</strong></p></li> <li><p><strong>请求参数</strong></p></li></ul> <table><thead><tr><th>参数</th> <th>参数名称</th> <th>类型</th> <th>必填</th> <th>参数说明</th></tr></thead> <tbody><tr><td>appId</td> <td>第三方应用唯一标识</td> <td>int</td> <td>是</td> <td>由小天才分配给接入方的应用标识ID</td></tr> <tr><td>appSecret</td> <td>第三方应用秘钥</td> <td>String</td> <td>是</td> <td>由小天才分配给接入方的应用秘钥</td></tr> <tr><td>grantType</td> <td>授权类型</td> <td>String</td> <td>是</td> <td>固定值: <strong>refresh_token</strong></td></tr> <tr><td>refreshToken</td> <td>刷新token</td> <td>String</td> <td>是</td> <td>3.2节token接口返回的refreshToken</td></tr></tbody></table> <ul><li>示例</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;appId&quot;</span><span class="token operator">:</span> <span class="token number">100001</span><span class="token punctuation">,</span>
    <span class="token property">&quot;appSecret&quot;</span><span class="token operator">:</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;grantType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;refresh_token&quot;</span><span class="token punctuation">,</span><span class="token comment">//固定值</span>
    <span class="token property">&quot;refreshToken&quot;</span><span class="token operator">:</span> <span class="token string">&quot;e6c189f9cc2449b59d5eff12c1616eed&quot;</span><span class="token comment">//刷新token(在获取token的接口会返回</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>响应消息</strong></li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token string">&quot;000001&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;desc&quot;</span><span class="token operator">:</span><span class="token string">&quot;SUCCESS&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;accessToken&quot;</span><span class="token operator">:</span><span class="token string">&quot;3d9eb36db7594c569702a940e9e86b0d&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;expiresTime&quot;</span><span class="token operator">:</span><span class="token number">259200</span><span class="token punctuation">,</span>
      <span class="token property">&quot;refreshToken&quot;</span><span class="token operator">:</span><span class="token string">&quot;8e49c6c296024518bf352c97a29cadf7&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;openId&quot;</span><span class="token operator">:</span><span class="token string">&quot;a614044b00a8406387aeba629b0e4f75&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;scope&quot;</span><span class="token operator">:</span><span class="token string">&quot;1&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p><strong>注意：</strong> 在使用过<code>refreshToken</code>之后，会返回一个新的<code>refreshToken</code>，原先的<code>refreshToken</code>一分钟后失效。</p></blockquote> <ul><li><strong>返回状态</strong></li></ul> <table><thead><tr><th>状态码</th> <th>提示消息</th></tr></thead> <tbody><tr><td>&quot;12001&quot;</td> <td>参数无效</td></tr> <tr><td>&quot;12002&quot;</td> <td>授权类型有误</td></tr> <tr><td>&quot;12007&quot;</td> <td>APPID或APPSecret信息无效</td></tr> <tr><td>&quot;12005&quot;</td> <td>refreshToken无效</td></tr> <tr><td>&quot;12006&quot;</td> <td>授权无效，重新走用户授权流程</td></tr></tbody></table> <h2 id="_4-获取用户账号信息"><a href="#_4-获取用户账号信息" class="header-anchor">#</a> 4. 获取用户账号信息</h2> <h3 id="_4-1-概述"><a href="#_4-1-概述" class="header-anchor">#</a> 4.1 概述</h3> <ul><li><strong>调用方：</strong> 第三方服务器</li> <li><strong>作用：</strong> 通过<code>accessToken</code>获取用户相关信息</li> <li><strong>测试环境域名：</strong> https://api-module.okii.com</li> <li><strong>正式环境域名：</strong> https://api.watch.okii.com</li></ul> <h3 id="_4-2-根据accesstoken获取用户信息"><a href="#_4-2-根据accesstoken获取用户信息" class="header-anchor">#</a> 4.2 根据accessToken获取用户信息</h3> <p>根据<code>accessToken</code>获取<strong>用户授权的信息</strong>，信息包括<strong>头像、昵称、用户的唯一标识openId</strong>（若第三方应用成功在平台上申请了其它权限，可获取更多授权信息）。</p> <h4 id="_4-2-1-接口说明"><a href="#_4-2-1-接口说明" class="header-anchor">#</a> 4.2.1 接口说明</h4> <ul><li><strong>请求方式：POST</strong></li> <li><strong>协议类型：HTTPS（POST请求）</strong></li> <li><strong>数据格式：json</strong></li> <li><strong>服务URL（测试环境域名）：https://api-module.okii.com/resource-service/resource/getUserInfo</strong></li> <li><strong>消息方向：第三方应用-&gt;资源服务</strong></li> <li><strong>请求参数</strong></li></ul> <table><thead><tr><th>参数</th> <th>参数名称</th> <th>类型</th> <th>必填</th> <th>参数说明</th></tr></thead> <tbody><tr><td>accessToken</td> <td>授权令牌</td> <td>String</td> <td>是</td> <td>授权令牌</td></tr> <tr><td>openId</td> <td>用户openId</td> <td>String</td> <td>是</td> <td>用户<code>openId</code>，<code>token</code>或者<code>refreshToken</code>返回的手表标识ID</td></tr></tbody></table> <ul><li>示例</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;openId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;f94d6ff02e134624bfd2fa1ddcb0fdd9&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;accessToken&quot;</span><span class="token operator">:</span> <span class="token string">&quot;c204f68d78aa41f88002f0f2374732d&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>响应消息</strong></li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
     <span class="token property">&quot;avatarUrl&quot;</span><span class="token operator">:</span><span class="token string">&quot;https://watchcdn.okii.com/xxx.jpg&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 手表头像地址</span>
     <span class="token property">&quot;nickName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zhangwtest&quot;</span><span class="token punctuation">,</span><span class="token comment">// 手表名称</span>
     <span class="token property">&quot;openId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;f94d6ff02e134624bfd2fa1ddcb0fdd9&quot;</span><span class="token punctuation">,</span>
     <span class="token property">&quot;unionId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cfghc6ff02e134624bfd2fa1ddcb0fdd9&quot;</span> <span class="token comment">//开发者和用户的唯一id</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>返回状态</strong></li></ul> <table><thead><tr><th>状态码</th> <th>提示消息</th></tr></thead> <tbody><tr><td>&quot;12001&quot;</td> <td>参数无效</td></tr> <tr><td>&quot;12008&quot;</td> <td>accessToken无效或过期</td></tr> <tr><td>&quot;12010&quot;</td> <td>无效openId</td></tr> <tr><td>&quot;12009&quot;</td> <td>该应用没有此权限</td></tr></tbody></table> <h3 id="_4-3-新openid转换成旧openid兼容逻辑处理-2019年9月之前接入的第三方使用"><a href="#_4-3-新openid转换成旧openid兼容逻辑处理-2019年9月之前接入的第三方使用" class="header-anchor">#</a> 4.3  新openId转换成旧openId兼容逻辑处理（2019年9月之前接入的第三方使用）</h3> <h4 id="_4-3-1-接口说明"><a href="#_4-3-1-接口说明" class="header-anchor">#</a> 4.3.1 接口说明</h4> <ul><li><strong>请求方式：POST</strong></li> <li><strong>协议类型：HTTPS</strong></li> <li><strong>数据格式：json</strong></li> <li><strong>服务URL（测试环境域名）：https://api-module.okii.com/resource-service/resource/getOldOpenId</strong></li> <li><strong>消息方向：第三方应用-&gt;获取用户账号信息服务</strong></li> <li><strong>请求参数</strong></li></ul> <table><thead><tr><th>参数</th> <th>参数名称</th> <th>类型</th> <th>必填</th> <th>参数说明</th></tr></thead> <tbody><tr><td>accessToken</td> <td>授权令牌</td> <td>String</td> <td>是</td> <td>授权令牌</td></tr> <tr><td>openId</td> <td>用户openId</td> <td>String</td> <td>是</td> <td>用户openId</td></tr> <tr><td>appId</td> <td>第三方应用id</td> <td>int</td> <td>是</td> <td>第三方应用id</td></tr></tbody></table> <ul><li>示例</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;appId&quot;</span><span class="token operator">:</span> <span class="token number">100005</span><span class="token punctuation">,</span>
	<span class="token property">&quot;authList&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
		<span class="token property">&quot;accessToken&quot;</span><span class="token operator">:</span> <span class="token string">&quot;58223983efd14a59ba37620379be85c2&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;openId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2d8b34acddb248898b5b178740f2fe26&quot;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;accessToken&quot;</span><span class="token operator">:</span> <span class="token string">&quot;704737e9feac4963bab34ea8b2451008&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;openId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;76ef8684e5014a3cb237878778f5085b&quot;</span>
	<span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>响应消息</strong></li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;000001&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;desc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SUCCESS&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token comment">// 新openId-&gt;旧openId的映射map</span>
		<span class="token string">&quot;76ef8684e5014a3cb237878&quot;</span>(新openId)<span class="token operator">:</span> <span class="token string">&quot;8461B6A1564DF055A54F3EFF053D93A3&quot;</span>(旧openId)<span class="token punctuation">,</span>
		<span class="token property">&quot;2d8b34acddb248898b5b178740f2fe26&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C8A58D1C2539A96AC85AEC2481D7BBD9FF42BC5E3&quot;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>返回状态</strong></li></ul> <table><thead><tr><th>状态码</th> <th>提示消息</th></tr></thead> <tbody><tr><td>&quot;12001&quot;</td> <td>参数无效</td></tr> <tr><td>&quot;12010&quot;</td> <td>无效openId</td></tr> <tr><td>&quot;12099&quot;</td> <td>其他错误</td></tr></tbody></table> <h2 id="_5-开放排名服务"><a href="#_5-开放排名服务" class="header-anchor">#</a> 5. 开放排名服务</h2> <h3 id="_5-1-概述"><a href="#_5-1-概述" class="header-anchor">#</a> 5.1 概述</h3> <ul><li><strong>调用方：</strong> 第三方服务器</li> <li><strong>作用：</strong> 实现排行榜功能，提高第三方应用活跃度</li> <li><strong>测试环境域名：</strong> https://api-module.okii.com</li> <li><strong>正式环境域名：</strong> https://api.watch.okii.com</li></ul> <h3 id="_5-2-开放排名服务时序图"><a href="#_5-2-开放排名服务时序图" class="header-anchor">#</a> 5.2 开放排名服务时序图</h3> <p><img src="static/picture/account02.7f74336d.png" alt="开放排名服务时序图"></p> <h3 id="_5-3-上传应用排名数据"><a href="#_5-3-上传应用排名数据" class="header-anchor">#</a> 5.3 上传应用排名数据</h3> <h4 id="_5-3-1-接口说明"><a href="#_5-3-1-接口说明" class="header-anchor">#</a> 5.3.1 接口说明</h4> <ul><li><strong>请求方式：POST</strong></li> <li><strong>协议类型：HTTPS（POST请求）</strong></li> <li><strong>数据格式：json</strong></li> <li><strong>服务URL（测试环境域名）：https://api-module.okii.com/resource-service/ranking/thirdParty/uploadData</strong></li> <li><strong>消息方向：第三方应用-&gt;开放排名服务</strong></li> <li><strong>请求参数</strong></li></ul> <table><thead><tr><th>参数</th> <th>参数名称</th> <th>类型</th> <th>必填</th> <th>参数说明</th></tr></thead> <tbody><tr><td>accessToken</td> <td>授权令牌</td> <td>String</td> <td>是</td> <td>授权令牌</td></tr> <tr><td>openId</td> <td>用户openId</td> <td>String</td> <td>是</td> <td>用户openId</td></tr> <tr><td>appId</td> <td>第三方应用id</td> <td>int</td> <td>是</td> <td>第三方应用id</td></tr> <tr><td>type</td> <td>应用排名类型</td> <td>int</td> <td>否</td> <td>第三方应用类型（旧数据和默认为1）</td></tr> <tr><td>data</td> <td>应用排名数据</td> <td>Object</td> <td>是</td> <td>应用排名数据（<strong>数字类型采用Long接收</strong>）</td></tr></tbody></table> <ul><li>示例</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;openId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;c5284b3270134be28e957fe570c3e54a&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;appId&quot;</span><span class="token operator">:</span> <span class="token number">100001</span><span class="token punctuation">,</span>
    <span class="token property">&quot;accessToken&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1d27d3391e094828b57db767b4161e93&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3&quot;</span>
<span class="token punctuation">}</span>



</code></pre></div><ul><li><strong>响应消息</strong></li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token string">&quot;000001&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;desc&quot;</span><span class="token operator">:</span><span class="token string">&quot;SUCCESS&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> 
<span class="token comment">//data等于1时上报成功，为-1时上报失败，null时未更新数据(非最高分)</span>



</code></pre></div><ul><li><strong>返回状态</strong></li></ul> <table><thead><tr><th>状态码</th> <th>提示消息</th></tr></thead> <tbody><tr><td>&quot;12001&quot;</td> <td>参数无效</td></tr> <tr><td>&quot;12010&quot;</td> <td>无效openId</td></tr> <tr><td>&quot;12011&quot;</td> <td>授权超过申请范围</td></tr> <tr><td>&quot;12099&quot;</td> <td>其他错误</td></tr> <tr><td>&quot;12009&quot;</td> <td>该appId没有权限</td></tr></tbody></table> <h3 id="_5-4-获取好友排行榜数据"><a href="#_5-4-获取好友排行榜数据" class="header-anchor">#</a> 5.4 获取好友排行榜数据</h3> <h4 id="_5-4-1-接口说明"><a href="#_5-4-1-接口说明" class="header-anchor">#</a> 5.4.1 接口说明</h4> <ul><li><strong>请求方式：POST</strong></li> <li><strong>协议类型：HTTPS</strong></li> <li><strong>数据格式：json</strong></li> <li><strong>服务URL（测试环境域名）：https://api-module.okii.com/resource-service/ranking/thirdParty/getRankingList</strong></li> <li><strong>消息方向：第三方应用-&gt;开放排名服务</strong></li> <li><strong>请求参数</strong></li></ul> <table><thead><tr><th>参数</th> <th>参数名称</th> <th>类型</th> <th>必填</th> <th>参数说明</th></tr></thead> <tbody><tr><td>accessToken</td> <td>授权令牌</td> <td>String</td> <td>是</td> <td>授权令牌</td></tr> <tr><td>openId</td> <td>用户openId</td> <td>String</td> <td>是</td> <td>用户openId</td></tr> <tr><td>appId</td> <td>第三方应用id</td> <td>int</td> <td>是</td> <td>第三方应用id</td></tr> <tr><td>type</td> <td>应用排名类型</td> <td>int</td> <td>否</td> <td>第三方应用类型（旧数据和默认为1）</td></tr> <tr><td>sortType</td> <td>应用排序类型</td> <td>String</td> <td>否</td> <td>排序类型:DESC,ASC（默认倒序）</td></tr> <tr><td>page</td> <td>分页参数</td> <td>Object</td> <td>否</td> <td>分页实体</td></tr></tbody></table> <ul><li>示例</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;openId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;c5284b3270134be28e957fe570c3e54a&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;appId&quot;</span><span class="token operator">:</span> <span class="token number">100001</span><span class="token punctuation">,</span>
    <span class="token property">&quot;accessToken&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1d27d3391e094828b57db767b4161e93&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sortType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;DESC&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;page&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token comment">// 分页参数，非必须，不填返回全部</span>
        <span class="token property">&quot;pageSize&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 一页的数量</span>
        <span class="token property">&quot;nowPage&quot;</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token comment">// 第几页</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



</code></pre></div><ul><li><strong>响应消息</strong></li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;000001&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;desc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SUCCESS&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token comment">// 排行数据列表</span>
      <span class="token punctuation">{</span>
		<span class="token property">&quot;openId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2d8b34acddb248898b5b178740f2fe26&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;白Z5&quot;</span><span class="token punctuation">,</span><span class="token comment">// 手表昵称</span>
		<span class="token property">&quot;icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://qn.authtest.okii.com/user_avat&quot;</span><span class="token punctuation">,</span><span class="token comment">// 头像地址</span>
		<span class="token property">&quot;appId&quot;</span><span class="token operator">:</span> <span class="token number">100005</span><span class="token punctuation">,</span>
		<span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token string">&quot;50&quot;</span><span class="token punctuation">,</span> 
		<span class="token property">&quot;rank&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 排名</span>
		<span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token comment">// 类型</span>
	  <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;extra&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token comment">// 个人的排名，rank值为-1时表示没有排行数据</span>
        <span class="token property">&quot;openId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;28a49be2c4334494a4aff0c3ec428438&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://qn.authtest.okii.com/user_avat&quot;</span><span class="token punctuation">,</span><span class="token comment">// 头像地址</span>
        <span class="token property">&quot;appId&quot;</span><span class="token operator">:</span> <span class="token number">100037</span><span class="token punctuation">,</span>
        <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token string">&quot;10&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;rank&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token comment">// 类型</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;page&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token comment">// 分页信息，入参有分页信息时则返回</span>
        <span class="token property">&quot;nowPage&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 当前页</span>
        <span class="token property">&quot;totalRecord&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span><span class="token comment">// 总记录数</span>
        <span class="token property">&quot;totalPage&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token comment">// 总页数</span>
        <span class="token property">&quot;pageSize&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token comment">// 一页的数量</span>
        <span class="token property">&quot;startIndex&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token comment">// 起始下标</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



</code></pre></div><ul><li><strong>返回状态</strong></li></ul> <table><thead><tr><th>状态码</th> <th>提示消息</th></tr></thead> <tbody><tr><td>&quot;12001&quot;</td> <td>参数无效</td></tr> <tr><td>&quot;12010&quot;</td> <td>无效openId</td></tr> <tr><td>&quot;12011&quot;</td> <td>授权超过申请范围</td></tr> <tr><td>&quot;12099&quot;</td> <td>其他错误，联系XTC开发查明原因</td></tr> <tr><td>&quot;12009&quot;</td> <td>该appId没有权限</td></tr></tbody></table> <h3 id="_5-5-获取校园排行榜数据"><a href="#_5-5-获取校园排行榜数据" class="header-anchor">#</a> 5.5 获取校园排行榜数据</h3> <h4 id="_5-5-1-接口说明-获取同一个学校内该应用的排行榜。"><a href="#_5-5-1-接口说明-获取同一个学校内该应用的排行榜。" class="header-anchor">#</a> 5.5.1 接口说明：获取同一个学校内该应用的排行榜。</h4> <ul><li><p><strong>请求方式：POST</strong></p></li> <li><p><strong>协议类型：HTTPS</strong></p></li> <li><p><strong>数据格式：json</strong></p></li> <li><p><strong>服务URL（测试环境域名）：https://api-module.okii.com/resource-service/ranking/thirdParty/getSchoolRankingList</strong></p></li> <li><p><strong>消息方向：第三方应用-&gt;开放排名服务</strong></p></li> <li><p><strong>注意：</strong></p> <ul><li><p>只会展示<strong>学校、年级和班级三项信息全部填写</strong>的数据。</p></li> <li><p>数据源数据<strong>并非实时数据</strong>，<strong>周一凌晨1点之前</strong>填写的周二同步，<strong>周四凌晨1点之前</strong>填写周五同步。如：我在周一早上9点填写了学校、年级和班级，那么数据会在周五进行同步，如果周日填写则周二同步。</p></li> <li><p>由于成本原因，<strong>测试环境的校园排行榜数据不再维护</strong>。</p> <blockquote><p>​	小天才这边的建议是测试环境确认好友排行榜没问题之后上正式测试校园排行榜，因为校园排行榜的参数跟好友排行榜是完全一致的，好友排行榜无误的话基本上校园排行榜的入参也不会有问题。</p></blockquote></li></ul></li> <li><p><strong>请求参数</strong></p></li></ul> <table><thead><tr><th>参数</th> <th>参数名称</th> <th>类型</th> <th>必填</th> <th>参数说明</th></tr></thead> <tbody><tr><td>accessToken</td> <td>授权令牌</td> <td>String</td> <td>是</td> <td>授权令牌</td></tr> <tr><td>openId</td> <td>用户openId</td> <td>String</td> <td>是</td> <td>用户openId</td></tr> <tr><td>appId</td> <td>第三方应用id</td> <td>int</td> <td>是</td> <td>第三方应用id</td></tr> <tr><td>type</td> <td>应用排名类型</td> <td>int</td> <td>否</td> <td>第三方应用类型（旧数据和默认为1）</td></tr> <tr><td>sortType</td> <td>应用排序类型</td> <td>String</td> <td>否</td> <td>排序类型:DESC,ASC（默认倒序）</td></tr> <tr><td>page</td> <td>分页实体</td> <td>Object</td> <td>否</td> <td>分页参数</td></tr></tbody></table> <ul><li>示例</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;openId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;c5284b3270134be28e957fe570c3e54a&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;appId&quot;</span><span class="token operator">:</span> <span class="token number">100001</span><span class="token punctuation">,</span>
    <span class="token property">&quot;accessToken&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1d27d3391e094828b57db767b4161e93&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sortType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;DESC&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;page&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token comment">// 选填，不填默认返回全部</span>
        <span class="token property">&quot;pageSize&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token comment">// 一页的数量</span>
        <span class="token property">&quot;nowPage&quot;</span><span class="token operator">:</span><span class="token number">1</span> <span class="token comment">// 第几页</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



</code></pre></div><ul><li><strong>响应消息</strong></li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;000001&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;desc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SUCCESS&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token comment">// 排行数据列表</span>
      <span class="token punctuation">{</span>
		<span class="token property">&quot;openId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2d8b34acddb248898b5b178740f2fe26&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;白Z5&quot;</span><span class="token punctuation">,</span><span class="token comment">// 手表昵称</span>
		<span class="token property">&quot;icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://qn.authtest.okii.com/user_avat&quot;</span><span class="token punctuation">,</span><span class="token comment">// 头像地址</span>
		<span class="token property">&quot;appId&quot;</span><span class="token operator">:</span> <span class="token number">100005</span><span class="token punctuation">,</span>
		<span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token string">&quot;50&quot;</span><span class="token punctuation">,</span> 
		<span class="token property">&quot;rank&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 排名</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token comment">// 类型</span>
	  <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;extra&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token comment">// 个人的排名，rank值为-1时表示没有排行数据</span>
        <span class="token property">&quot;openId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;28a49be2c4334494a4aff0c3ec428438&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://qn.authtest.okii.com/user_avat&quot;</span><span class="token punctuation">,</span><span class="token comment">// 头像地址</span>
        <span class="token property">&quot;appId&quot;</span><span class="token operator">:</span> <span class="token number">100037</span><span class="token punctuation">,</span>
        <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token string">&quot;10&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;rank&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token comment">// 类型</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;page&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token comment">// 分页信息，入参有分页信息时则返回</span>
        <span class="token property">&quot;nowPage&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 当前页</span>
        <span class="token property">&quot;totalRecord&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span><span class="token comment">// 总记录数</span>
        <span class="token property">&quot;totalPage&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token comment">// 总页数</span>
        <span class="token property">&quot;pageSize&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token comment">// 一页的数量</span>
        <span class="token property">&quot;startIndex&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token comment">// 起始下标</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



</code></pre></div><ul><li><strong>返回状态</strong></li></ul> <table><thead><tr><th>状态码</th> <th>提示消息</th></tr></thead> <tbody><tr><td>&quot;12001&quot;</td> <td>参数无效</td></tr> <tr><td>&quot;12010&quot;</td> <td>无效openId</td></tr> <tr><td>&quot;12011&quot;</td> <td>授权超过申请范围</td></tr> <tr><td>&quot;12099&quot;</td> <td>其他错误，联系XTC开发查明原因</td></tr> <tr><td>&quot;12009&quot;</td> <td>此范围未授权</td></tr> <tr><td>&quot;12012&quot;,&quot;12206&quot;</td> <td>用户没有填写学校年级班级信息，或者还未进行同步，原因见<a href="#_5-5-获取校园排行榜数据">5.5.1 接口说明</a>的<strong>注意</strong></td></tr></tbody></table></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2021/9/3 上午10:53:54</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="02-permission.html" class="prev">
        应用权限
      </a></span> <span class="next"><a href="08-service.html">
        应用服务号
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="static/js/app.c5cf0902.js" defer=""></script><script src="static/js/2.64c56ba3.js" defer=""></script><script src="static/js/8.63a01d72.js" defer=""></script>
  </body>
</html>
